{% extends "index.html" %}

{% block content %}
<!-- Your content goes here -->
<!-- Custom CSS is linked in head or included in style tag -->
 <style>
    :root {
    --primary: #38e0ff;
    --primary-dark: #3a56d4;
    --primary-light: #4f70ff;
    --secondary: #191C24;
    --light: #6C7293;
    --dark: #000000;
    --accent: #00b4d8;
    --accent-dark: #0096c7;
    --danger: #ef476f;
    --success: #06d6a0;
    --warning: #ffd166;
    --card-bg: #ffffff;
    --hover-bg: #f0f4ff;
}

.dashboard {
    background-color:var(--secondary);
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    padding: 25px;
    margin-bottom: 25px;
    border-left: 5px solid var(--primary);
    color: #fff;
    transition: all 0.3s ease;
}

.dashboard:hover {
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
    transform: translateY(-2px);
}

.dashboard h5 {
    color: var(--primary);
    font-weight: 600;
    letter-spacing: 0.5px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(108, 114, 147, 0.2);
    margin-bottom: 20px;
}

/* Button Styling */
.btn {
    border-radius: 6px;
    padding: 8px 16px;
    font-weight: 500;
    transition: all 0.2s ease;
}

.btn-outline-primary {
    color: var(--primary);
    border-color: var(--primary);
}

.btn-outline-primary:hover {
    background-color: var(--primary);
    color: var(--dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(56, 224, 255, 0.3);
}

.btn-dark {
    background-color: var(--accent);
    border-color: var(--accent);
}

.btn-dark:hover {
    background-color: var(--accent-dark);
    border-color: var(--accent-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 180, 216, 0.3);
}

.btn-primary {
    background-color: var(--primary);
    border-color: var(--primary);
    color: var(--dark);
}

.btn-primary:hover {
    background-color: var(--primary-light);
    border-color: var(--primary-light);
    color: var(--dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(56, 224, 255, 0.3);
}

.btn-danger {
    background-color: var(--danger);
    border-color: var(--danger);
}

.btn-danger:hover {
    background-color: #d63d66;
    border-color: #d63d66;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(239, 71, 111, 0.3);
}

.btn-sm {
    padding: 5px 10px;
    font-size: 0.85rem;
}

.btn i {
    margin-right: 5px;
}

/* DataTable specific styling */
.dataTables_wrapper .dataTables_length,
.dataTables_wrapper .dataTables_filter,
.dataTables_wrapper .dataTables_info,
.dataTables_wrapper .dataTables_processing,
.dataTables_wrapper .dataTables_paginate {
    color: var(--light) !important;
    margin-bottom: 15px;
}

.dataTables_wrapper .dataTables_filter input {
    background-color: rgba(25, 28, 36, 0.7);
    border: 1px solid var(--light);
    color: #fff;
    border-radius: 6px;
    padding: 8px 12px;
    margin-left: 8px;
    transition: all 0.3s ease;
}

.dataTables_wrapper .dataTables_filter input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(56, 224, 255, 0.25);
    outline: none;
}

.dataTables_wrapper .dataTables_length select {
    background-color: rgba(25, 28, 36, 0.7);
    border: 1px solid var(--light);
    color: #fff;
    border-radius: 6px;
    padding: 8px 10px;
    transition: all 0.3s ease;
}

.dataTables_wrapper .dataTables_length select:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(56, 224, 255, 0.25);
    outline: none;
}

.dataTables_wrapper .dataTables_paginate {
    margin-top: 15px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
    color: var(--light) !important;
    border: 1px solid transparent;
    background: transparent;
    box-shadow: none;
    border-radius: 4px;
    margin: 0 3px;
    transition: all 0.2s ease;
}

.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
    color: var(--primary) !important;
    border: 1px solid var(--primary);
    background: rgba(56, 224, 255, 0.1);
    transform: translateY(-1px);
}

.dataTables_wrapper .dataTables_paginate .paginate_button.current,
.dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
    color: var(--dark) !important;
    background: var(--primary) !important;
    border: 1px solid var(--primary) !important;
    font-weight: 600;
}

.dataTables_wrapper .dataTables_paginate .paginate_button.disabled,
.dataTables_wrapper .dataTables_paginate .paginate_button.disabled:hover {
    color: var(--light) !important;
    opacity: 0.5;
}

table.dataTable {
    border-collapse: separate !important;
    border-spacing: 0;
    margin-top: 20px !important;
    margin-bottom: 20px !important;
    width: 100% !important;
    border-radius: 8px;
    overflow: hidden;
}

table.dataTable thead th {
    background-color: rgba(0, 0, 0, 0.2);
    /* color: var(--hover-bg); */
    border-bottom: 2px solid var(--accent) !important;
    padding: 15px 12px;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
}

table.dataTable tbody tr {
    color: #fff !important;
    transition: all 0.2s ease;
}

table.dataTable tbody tr:nth-of-type(odd) {
    background-color: rgba(0, 0, 0, 0.1);
    color: #000000;
}

table.dataTable tbody tr:hover {
    background-color: rgba(56, 224, 255, 0.1);
}

table.dataTable tbody td {
    padding: 15px 12px;
    border-bottom: 1px solid rgba(108, 114, 147, 0.2);
    vertical-align: middle;
    /* color: var(--hover-bg) !important; */
    color: #000000 !important;
}

/* Badge styling */
.badge {
    padding: 7px 12px;
    font-weight: 500;
    border-radius: 6px;
    letter-spacing: 0.3px;
    transition: all 0.2s ease;
}

.bg-success {
    background-color: var(--success) !important;
}

.bg-danger {
    background-color: var(--danger) !important;
}

/* Modal styling */
.modal-content {
    background-color: var(--secondary);
    border: none;
    border-radius: 12px;
    color: #fff;
}

.modal-header {
    border-bottom: 1px solid rgba(108, 114, 147, 0.2);
    padding: 20px 25px;
}

.modal-header .modal-title {
    color: var(--primary);
    font-weight: 600;
}

.modal-header .btn-close {
    color: #fff;
    background: rgba(255, 255, 255, 0.1);
    opacity: 0.8;
}

.modal-body {
    padding: 25px;
}

.modal-footer {
    border-top: 1px solid rgba(108, 114, 147, 0.2);
    padding: 20px 25px;
}

/* Add Company Button Enhancement */
.btn-add-company {
    display: inline-flex;
    align-items: center;
    background-color: transparent;
    border: 2px dashed var(--primary-light);
    color: var(--primary-light);
    padding: 10px 18px;
    border-radius: 8px;
    transition: all 0.3s ease;
    margin-bottom: 20px;
}

.btn-add-company:hover {
    background-color: var(--primary);
    color: var(--dark);
    border-style: solid;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(56, 224, 255, 0.3);
}

.btn-add-company i {
    font-size: 1.1rem;
    margin-right: 8px;
}

/* Actions Column Styling */
.action-buttons {
    display: flex;
    gap: 5px;
}

.action-buttons .btn {
    padding: 6px 12px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .dashboard {
        padding: 15px;
    }
    
    table.dataTable tbody td {
        padding: 10px 8px;
    }
    
    .action-buttons {
        flex-direction: column;
        gap: 5px;
    }
    
    .action-buttons .btn {
        width: 100%;
        margin-bottom: 5px;
    }
}

/* Loading state animation */
.dataTables_processing {
    background-color: rgba(25, 28, 36, 0.8) !important;
    color: var(--primary) !important;
    border-radius: 8px;
    padding: 10px !important;
    border: 1px solid var(--primary);
}
.dashboard-card{
    color: #000000 !important ;
}
 </style>

<!-- Main Content Row -->
<div class="row g-4">
    <div class="col-lg-12">
        <!-- Websites Section -->
        <div class="dashboard-card">
            <h5>Registered Companies</h5>
            
            <button class="btn-add-company" data-bs-toggle="modal" data-bs-target="#exampleModal">
                <i class="bi bi-plus-circle"></i> Add New Company
            </button>
            
            <div class="list-group">
                <div class="table-responsive">
                    <table id="companyTable" class="table  table-striped" style="background-color: var(--card-bg) !important;">
                        <thead>
                            <tr>
                                <th>Company Name</th>
                                <th>Date Added</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td>
                                    <div class="fw-bold">{{ user.company_name }}</div>
                                </td>
                                <td>{{ user.date_joined }}</td>
                                <td>{{ user.phone }}</td>
                                <td>{{ user.email }}</td>
                                <td>
                                    {% if user.is_active == True %}
                                        <span class="badge bg-success">Active</span>
                                    {% else %}
                                        <span class="badge bg-danger">Inactive</span>
                                    {% endif %}
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <a href="{%url 'update_company' user.id %}" class="btn btn-dark btn-sm">
                                            <i class="bi bi-eye"></i> View
                                        </a>
                                        <button class="btn btn-primary btn-sm">
                                            <i class="bi bi-pencil"></i> Edit
                                        </button>
                                        <button class="btn btn-danger btn-sm">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Adding Company -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">
                    <i class="bi bi-building"></i> Add New Company
                </h5>
                <button type="button" class="btn-close bg-danger" data-bs-dismiss="modal" aria-label="Close">X</button>
            </div>
            <div class="modal-body bg-white text-dark">
                <form id="addCompanyForm" method="post" enctype="multipart/form-data">
                    {% csrf_token%}
                    <div class="row">
                    {% for field in form %}
                    <div class="form-group col-md-6">
                    
                        <label for="companyName" class="form-label">{{field.label}}</label>
                        {{field}}
                    </div>
                    {% endfor %}
                    </div>
                    
                    
            </div>
            <div class="modal-footer bg-muted text-dark">
                <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-save"></i> Save Company
                </button>
            </form>

            </div>
        </div>
    </div>
</div>

<!-- DataTables CSS CDN -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">

<!-- jQuery CDN -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- DataTables JS CDN -->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>

<!-- Custom DataTable Initialization -->
<script>
    $(document).ready(function() {
        $('#companyTable').DataTable({
            responsive: true,
            language: {
                search: "<i class='bi bi-search'></i>",
                searchPlaceholder: "Search companies...",
                lengthMenu: "Show _MENU_ entries",
                info: "Showing _START_ to _END_ of _TOTAL_ companies",
                infoEmpty: "No companies found",
                infoFiltered: "(filtered from _MAX_ total companies)",
                zeroRecords: "No matching companies found",
                paginate: {
                    first: "<i class='bi bi-chevron-double-left'></i>",
                    last: "<i class='bi bi-chevron-double-right'></i>",
                    next: "<i class='bi bi-chevron-right'></i>",
                    previous: "<i class='bi bi-chevron-left'></i>"
                }
            },
            pageLength: 10,
            lengthMenu: [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]],
            order: [[1, 'desc']], // Sort by date added (newest first)
            columnDefs: [
                { orderable: false, targets: 5 }, // Disable sorting on actions column
                { className: "text-center", targets: [4, 5] } // Center align status and actions columns
            ],
            initComplete: function() {
                // Add custom filter for status
                var statusColumn = this.api().column(4);
                var select = $('<select class="form-select form-select-sm ms-2"><option value="">All Status</option><option value="Active">Active</option><option value="Inactive">Inactive</option></select>')
                    .appendTo('#companyTable_filter')
                    .on('change', function() {
                        var val = $.fn.dataTable.util.escapeRegex($(this).val());
                        statusColumn
                            .search(val ? val : '', true, false)
                            .draw();
                    });
            }
        });
        
        // Add tooltip functionality
        $('[data-bs-toggle="tooltip"]').tooltip();
        
        // Make status badges clickable to toggle status
        $('.badge').css('cursor', 'pointer').on('click', function() {
            var current = $(this).text();
            if (current === 'Active') {
                $(this).removeClass('bg-success').addClass('bg-danger').text('Inactive');
            } else {
                $(this).removeClass('bg-danger').addClass('bg-success').text('Active');
            }
        });
    });
</script>
{% endblock %}